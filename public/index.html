<script>
  window.addEventListener('DOMContentLoaded', function () {
    function byText(){const n=t=>t.toLowerCase();const btns=[...document.querySelectorAll('button,input[type=button],input[type=submit]')];
      return (arr)=>btns.find(b=>arr.some(t=>(b.value||b.innerText||'').toLowerCase().includes(n(t))));}
    const find = byText();

    function bindButtons(){
      try {
        const c = find(['skapa saga','skapa & l\u00e4s upp','skapa']);
        const p = find(['l\u00e4s upp','spela','testa r\u00f6st']);
        if (c) c.onclick = (e)=>{ e.preventDefault?.(); if (window.createStory) return window.createStory(); console.warn('createStory saknas'); };
        if (p) p.onclick = (e)=>{ e.preventDefault?.(); if (window.playTTS) return window.playTTS(); console.warn('playTTS saknas'); };
        console.log('BN inline-binder attempted');
      } catch (err) {
        console.warn('BN binder error', err);
      }
    }

    // Försök binda om createStory inte finns direkt — gör upp till 20 försök (2s)
    if (window.createStory && window.playTTS) {
      bindButtons();
    } else {
      let tries = 0;
      const iv = setInterval(()=>{
        tries++;
        if (window.createStory || window.playTTS) {
          bindButtons();
          clearInterval(iv);
        } else if (tries > 20) {
          bindButtons(); // bind anyway för fall där globalerna dyker upp senare
          clearInterval(iv);
        }
      }, 100);
    }
  });
</script>

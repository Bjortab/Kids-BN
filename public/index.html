<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BN‚Äôs Sagov√§rld ‚Äî ‚Ä¶d√§r dr√∂mmar blir ber√§ttelser</title>

  <style>
    :root{
      --bg:#0e0f12; --panel:#16181d; --text:#e8f0ff;
      --muted:#9aa4b2; --accent:#2be28f; --accent-2:#1ea7fd;
      --danger:#ff4d4f; --ok:#31d0aa; --line:#252a33;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0; padding:24px; background:var(--bg); color:var(--text);
      font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    .wrap{
      max-width: 880px; margin: 0 auto;
    }
    h1{
      text-align:center; margin:0 0 .25rem 0; color:#2be28f;
      font-weight:800; letter-spacing:.3px;
    }
    .sub{ text-align:center; margin:0 0 18px 0; color:var(--muted); font-size:.92rem; }
    .panel{
      background:var(--panel); border:1px solid var(--line);
      border-radius:12px; padding:18px; margin-bottom:16px;
    }

    label{ display:block; font-size:.86rem; color:var(--muted); margin: 12px 0 6px; }
    input[type="text"], textarea, select{
      width:100%; background:#0f1116; color:var(--text);
      border:1px solid var(--line); border-radius:10px; padding:12px 12px;
      outline:none; transition:border .15s ease;
    }
    textarea{ min-height: 96px; resize: vertical; }
    input:focus, textarea:focus, select:focus{ border-color:#2a8af7; }

    .row { display:flex; gap:12px; flex-wrap:wrap; }
    .row > * { flex:1 1 240px; }

    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:12px; }
    .btn{
      border:0; background:#232833; color:var(--text); padding:10px 14px;
      border-radius:10px; cursor:pointer; font-weight:600; transition:.15s ease;
    }
    .btn:disabled{ opacity:.5; cursor:not-allowed; }
    .btn--primary{ background: var(--accent); color:#04110a; }
    .btn--accent { background: var(--accent-2); }
    .btn--warn{ background:#f2c230; color:#1c1500; }
    .btn--ghost{ background:#232833; }

    .status{ margin:10px 0 4px; min-height: 20px; font-size:.92rem; }
    .status--ok{ color: var(--ok); }
    .status--error{ color: var(--danger); }

    .result { margin-top:10px; }
    .result pre{
      white-space:pre-wrap; background:#0f1116; border:1px solid var(--line);
      padding:14px; border-radius:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:.94rem;
    }
    audio{ width:100%; margin-top:10px; }

    /* Spinners & cache meter */
    .spinner{ margin:.4rem 0; font-size:.92rem; opacity:.85; }
    .spinner::before{
      content:""; display:inline-block; width:14px; height:14px; margin-right:8px;
      border:2px solid #778399; border-top-color:#fff; border-radius:50%;
      vertical-align:-2px; animation:spin .75s linear infinite;
    }
    @keyframes spin{ to{ transform:rotate(360deg);} }
    .cache{ margin:.5rem 0 1rem; }
    .cache__label{ font-size:.86rem; color:var(--muted); margin-bottom:.35rem; }
    .cache__bar{ height:8px; background:#2a2f38; border-radius:6px; overflow:hidden; }
    .cache__bar span{ display:block; height:100%; width:0%; background:var(--accent); transition: width .35s ease; }

    /* Image cards (framtidss√§kert) */
    .img-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(180px,1fr)); gap:12px; }
    .story-image-card{ background:#0f1116; border:1px solid var(--line); border-radius:10px; overflow:hidden; }
    .story-image-card img{ display:block; width:100%; height:auto; }
    .foot{ text-align:center; color:var(--muted); font-size:.82rem; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="wrap">

    <h1>BN‚Äôs Sagov√§rld</h1>
    <div class="sub">‚Ä¶d√§r dr√∂mmar blir ber√§ttelser</div>

    <div class="panel">
      <div class="row">
        <div>
          <label for="childName">Barnets namn</label>
          <input id="childName" type="text" placeholder="t.ex. Lisa" />
        </div>
        <div>
          <label for="ageRange">√Ölder</label>
          <select id="ageRange">
            <option value="1-2">1‚Äì2 √•r</option>
            <option value="3-4">3‚Äì4 √•r</option>
            <option value="5-6" selected>5‚Äì6 √•r</option>
            <option value="7-8">7‚Äì8 √•r</option>
            <option value="9-10">9‚Äì10 √•r</option>
            <option value="11-12">11‚Äì12 √•r</option>
          </select>
        </div>
      </div>

      <label for="prompt">Sagognista (vad ska sagan handla om?)</label>
      <textarea id="prompt" placeholder="En liten drake l√§rde sig flyga‚Ä¶"></textarea>

      <div class="controls">
        <label><input id="useWhisper" type="checkbox" /> Anv√§nd extra exakt r√∂sttolkning (Whisper)</label>
      </div>

      <label for="heroName">Hj√§ltens namn (valfritt)</label>
      <input id="heroName" type="text" placeholder="t.ex. Drakil eller Prinsessan Nila" />

      <div class="controls">
        <button id="btnSpeak" class="btn btn--accent">üéôÔ∏è Tala in</button>
        <button id="btnGenerate" class="btn btn--primary">üíö Skapa saga (med uppl√§sning)</button>
        <button id="btnSaveHero" class="btn btn--warn">‚≠ê Spara hj√§lte</button>
        <button id="btnResetHeroes" class="btn btn--ghost">üóëÔ∏è Rensa hj√§ltar</button>
      </div>

      <div id="status" class="status"></div>

      <!-- Spinners -->
      <div id="storySpinner" class="spinner" hidden>Skapar saga ‚Ä¶</div>
      <div id="ttsSpinner"   class="spinner" hidden>Skapar uppl√§sning ‚Ä¶</div>

      <!-- Cache meter f√∂r TTS -->
      <div id="cacheWrap" class="cache" hidden>
        <div id="cacheText" class="cache__label">√Öteranv√§nt fr√•n minnet: 0%</div>
        <div class="cache__bar"><span id="cacheBar"></span></div>
      </div>

      <div class="result">
        <pre id="resultText"></pre>
        <audio id="resultAudio" hidden controls></audio>
      </div>

      <!-- Framtida bildvisning (l√§mnas tom om ej i bruk) -->
      <div id="storyImages" class="img-grid"></div>

      <div class="foot">¬© BN ‚Äî barnv√§nlig magi, inget konto kr√§vs f√∂r att prova</div>
    </div>
  </div>

  <script src="/app.js" defer></script>
</body>
</html>
